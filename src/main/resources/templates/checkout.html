<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang Thanh To√°n</title>
	<link rel="icon" href="https://gigamall.com.vn/data/2024/05/10/14290213_shushiwa.jpg" type="image/x-icon">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
	<!-- AOS CSS -->
	<link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">

	<link href="index.css" rel="stylesheet">
	<link href="menu.css" rel="stylesheet">
	<!-- Th√™m Font Awesome CDN -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
		.star-rating {
				  display: inline-flex;
				  font-size: 50px; /* K√≠ch th∆∞·ªõc c·ªßa ng√¥i sao */
				  color: #ccc; /* M√†u m·∫∑c ƒë·ªãnh (x√°m) */
				}

				.star-rating .star {
				  cursor: default;
				}

				.star-rating .star.filled {
				  color: gold; /* M√†u v√†ng cho sao ƒë∆∞·ª£c t√¥ */
				}

				.product-detail {
				    max-width: 1000px;
				    margin: auto;
					margin-top: 100px;
				    display: flex;
				    align-items: flex-start;
				    gap: 20px;
				}

				.product-detail img {
				    width: 40%; /* Chi·∫øm 40% chi·ªÅu r·ªông */
				    border-radius: 8px;
				}

				.product-info {
				    width: 60%; /* Chi·∫øm 60% chi·ªÅu r·ªông */
				}

				.product-info h1 {
				    font-size: 2rem;
				    margin-bottom: 15px;
				}

				.product-info p {
				    font-size: 1rem;
				    margin-bottom: 8px;
				}


		        .suggested-items {
		            margin: 40px;
		        }

		        .suggested-items h3 {
		            font-size: 1.8rem;
		            margin-bottom: 20px;
		        }

		        .suggested-items .item-card {
		            margin-bottom: 20px;
		        }

		        .suggested-items .card-body {
		            text-align: center;
		        }
				.price {
				    color: #ff7f50;
				    font-weight: bold;
				}
				#toastNotification {
			      animation: slide-in 0.5s ease, fade-out 0.5s 4.5s ease;
			  }
			  .modal-content2 {
			  padding: 50px	;
			      max-width: 100%;
			      max-height: 100%;
			      object-fit: contain; /* ƒê·∫£m b·∫£o h√¨nh ·∫£nh kh√¥ng m√©o */
			      transition: transform 0.3s ease-in-out;
			      background-color: #fdf5f3;
			      padding: 10px; /* Th√™m kho·∫£ng tr·ªëng ƒë·ªÉ h√¨nh ·∫£nh kh√¥ng b·ªã s√°t vi·ªÅn */
				  margin: 0 auto;
				  box-sizing: border-box;
			  }


				  /* C·ªë ƒë·ªãnh controls ·ªü d∆∞·ªõi c√πng */
				  .controls {
				      position: fixed;
				      bottom: 20px;  /* C√°ch m√©p d∆∞·ªõi trang web 20px */
				      left: 50%;
				      transform: translateX(-50%);
				      display: flex;
				      gap: 10px;
				  }

				  .controls button {
				      font-size: 20px;
				      padding: 10px 15px;
				      cursor: pointer;
				      background: white;
				      border: none;
				      border-radius: 5px;
				  }

				  /* N√∫t ƒë√≥ng */
				  .close {
				      position: fixed;
				      top: 15px;
				      right: 25px;
				      color: white;
				      font-size: 30px;
				      cursor: pointer;
				      background: rgba(0, 0, 0, 0.5);
				      padding: 5px 15px;
				      border-radius: 5px;
				      z-index: 10000; /* ƒê·∫£m b·∫£o lu√¥n n·∫±m tr√™n t·∫•t c·∫£ c√°c ph·∫ßn kh√°c */
				  }


				  @keyframes slide-in {
				      from {
				          transform: translateX(100%);
				          opacity: 0;
				      }
				      to {
				          transform: translateX(0);
				          opacity: 1;
				      }
				  }

				  @keyframes fade-out {
				      from {
				          opacity: 1;
				      }
				      to {
				          opacity: 0;
				      }
				  }
		#voucherCode::placeholder {
		    font-size: 12px; /* ƒêi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc theo mong mu·ªën */
		    color: #999; /* (Tu·ª≥ ch·ªçn) Thay ƒë·ªïi m√†u ch·ªØ n·∫øu c·∫ßn */
		}

		.voucher-card {
		    background: #f8f9fa;
		    border-left: 5px solid #007bff;
		    transition: 0.3s;
		}

		.voucher-card:hover {
		    transform: translateY(-3px);
		    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
		}

		.btn-success {
		    background-color: #28a745 !important;
		}
		.modal-dialog {
		    display: flex;
		    justify-content: center;
		    align-items: center;
		    min-height: 80vh;
		}

		.spinner-pulse {
		      border: 4px solid #f3f3f3;
		      border-top: 4px solid #3498db;
		      border-radius: 50%;
		      width: 50px;
		      height: 50px;
		      animation: spin 2s linear infinite, pulse 1.5s ease-in-out infinite;
		  }

		  @keyframes spin {
		      0% { transform: rotate(0deg); }
		      100% { transform: rotate(360deg); }
		  }

		  @keyframes pulse {
		      0% { transform: scale(1); opacity: 1; }
		      50% { transform: scale(1.2); opacity: 0.6; }
		      100% { transform: scale(1); opacity: 1; }
		  }
		.dashed-border-right {
		    border-right: 2px dashed #ddd;

		}
		.dashed-border-left {
				    border-left: 2px dashed #ddd;

				}

       
        h1 {
            font-weight: bold;
            font-size: 2rem;
            text-align: center;
            margin-bottom: 30px;
        }
        .table thead th {
            font-weight: bold;
            text-transform: uppercase;
            font-size: 1rem;
            border-bottom: 2px solid #ddd;
        }
        .table tbody td {
            vertical-align: middle;
        }
        .cart-summary {
            border: 1px solid #ddd;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
			height: max-content;
        }
        .cart-summary h5 {
            font-weight: bold;
        }
        .cart-summary .total-amount {
            font-size: 1.5rem;
            font-weight: bold;
        }
        .btn-primary {
            background-color: #ff6f61;
            border-color: #ff6f61;
        }
        .btn-primary:hover {
            background-color: #ff4f41;
            border-color: #ff4f41;
        }
		.scrollable-div {
		    max-height: 530px; /* ƒê·∫∑t chi·ªÅu cao t·ªëi ƒëa theo nhu c·∫ßu */
		    overflow-y: auto; /* Th√™m thanh cu·ªôn d·ªçc n·∫øu n·ªôi dung v∆∞·ª£t qu√° chi·ªÅu cao */
		   
		}
		.voucher-card-container {
		    display: flex;
		    justify-content: center;
		    margin-top: 15px;
		}

		.voucher-card {
		    display: flex;
		    align-items: center;
		    width: 100%;
		    max-width: 500px;
		    background: #f8f9fa;
		    border-radius: 10px;
		    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
		    overflow: hidden;
		}

		.voucher-image img {
		    width: 100px;
		    height: 140px;
		    object-fit: cover;
		    border-radius: 10px 0 0 10px;
		}

		.voucher-details {
		    flex-grow: 1;
		    padding: 10px;
		}

		.voucher-title {
		    font-size: 16px;
		    font-weight: bold;
		    margin-bottom: 5px;
		}

		.voucher-discount {
		    font-size: 15px;
		    font-weight: bold;
		    color: #28a745;
		}

		.voucher-expiry {
		    font-size: 13px;
		    color: #666;
		}

		.voucher-actions {
		    justify-content: flex-end;  /* ƒê·∫©y n·ªôi dung v·ªÅ b√™n ph·∫£i */
		    align-items: center;  /* CƒÉn gi·ªØa theo chi·ªÅu d·ªçc */
		    gap: 10px;  /* Kho·∫£ng c√°ch gi·ªØa n√∫t "H·ªßy" v√† "ƒêi·ªÅu ki·ªán" */
		    padding: 10px;
		}

		.voucher-actions button {
		    padding: 5px 12px;
		    font-size: 13px;
		    font-weight: bold;
		}
		
		.voucher-actions a {
		    text-decoration: none;
		    font-size: 13px;
		    font-weight: bold;
		    color: #007bff; /* M√†u xanh ƒë·∫∑c tr∆∞ng */
		    white-space: nowrap; /* Gi·ªØ ch·ªØ tr√™n c√πng m·ªôt d√≤ng */
		    display: inline-block; /* ƒê·∫£m b·∫£o kh√¥ng b·ªã xu·ªëng d√≤ng */
		    margin-top: auto; /* ƒê·∫©y xu·ªëng d∆∞·ªõi c√πng */
		}
		.modal-overlay {
		    position: fixed;
		    top: 0;
		    left: 0;
		    width: 100%;
		    height: 100%;
		    z-index: 1049; /* ƒê·∫∑t d∆∞·ªõi modal-content nh∆∞ng tr√™n backdrop c·ªßa Bootstrap */
		}
		/* ƒê·∫£m b·∫£o modal v·∫´n b·∫•m ƒë∆∞·ª£c */
		.modal-dialog {
		    position: relative;
		    z-index: 1051;
		}
		.line-loading {
		  width: 100%;
		  height: 4px;
		  position: relative;
		  overflow: hidden;
		  margin-top: 10px;
		  border-radius: 2px;
		}

		.line-loading::after {
		  content: "";
		  position: absolute;
		  width: 50%; /* ƒê·ªô d√†i hi·ªáu ·ª©ng ch·∫°y */
		  height: 100%;
		  background-color: #FFC107; /* M√†u xanh th√†nh c√¥ng */
		  animation: lineLoad 2s linear infinite;
		}

		@keyframes lineLoad {
		  0% {
		    left: -50%;
		  }
		  100% {
		    left: 100%;
		  }
		}

    </style>
</head>
<body>
	<!-- Navbar tr√™n m√†n h√¨nh l·ªõn -->
	<th:block th:replace="fragments/header :: header"></th:block>
	<script src="/js/chatbot.js"></script>
 
	<div class="container mt-5">
	    <h1>Trang Thanh To√°n</h1>
		<div class="cart-summary">
	    <div class="row">
	        <div class="col-md-4 dashed-border-right scrollable-div">
				<div class="align-items-center">
				    <label for="orderCode" class="form-label me-2">M√£ ƒë∆°n h√†ng:</label>
				    <span id="orderCode" class="form-label me-2 fw-bold" th:text="${orderCode}">0</span>
				</div>
				<hr>
				<table class="table">
				    <thead>
				        <tr>
				            <th colspan="2">M√≥n ƒÉn</th>
				            <th>Gi√°</th>
				            <th>SL</th>
				            <th>T·ªïng</th>
				        </tr>
				    </thead>
				    <tbody>
				        <tr th:each="item : ${cartItems}">
				            <td><img th:src="${item.imageUrl}" alt="Picture" width="50" onclick="openModal(this)"></td>
				            <td th:text="${item.name}"></td>
				            <td th:text="${#numbers.formatInteger(item.price, 0, 'POINT')}"></td>
				            <td th:text="${item.quantity}"></td>
							<td th:text="${#numbers.formatInteger(item.price * item.quantity, 0, 'POINT')}"></td>
				        </tr>
				    </tbody>
				</table>
			</div>
				<div class="col-md-4">
				<div class="payment-summary">
				    <!-- ƒêi·ªÉm kh·∫£ d·ª•ng -->
					<h4>Th√¥ng Tin Thanh To√°n</h4>
					<hr>
					<div class="mb-3 mt-3 d-flex align-items-center">
					    <label for="availablePoints" class="form-label me-2">S·ªë ƒëi·ªÉm kh·∫£ d·ª•ng:</label>
					    <span id="availablePoints" class="form-label me-2 fw-bold" th:text="${availablePoints}">0</span>
					</div>
					<div class=" justify-content-between mb-3">
						<!-- D√πng ƒëi·ªÉm -->
						<div class="align-items-center flex-grow-1">
						    <label for="pointsToUse" class="form-label me-2">D√πng ƒëi·ªÉm:</label>
						    <form th:action="@{/applyPoints}" method="post" class="d-flex flex-grow-1">
						        <input type="number" class="form-control" id="pointsToUse" name="pointsToUse"
						               min="0" th:max="${availablePoints}" th:value="${session.pointsToUse}">
						        <button type="submit" class="btn btn-sm btn-primary ms-2">√Åp d·ª•ng</button>
						    </form>
						</div>

						<!-- √î nh·∫≠p voucher (B·∫•m v√†o s·∫Ω m·ªü modal) -->
						<div class="align-items-center flex-grow-1">
						    <label for="voucherCode" class="form-label me-2">M√£ voucher:</label>
						    <div class="input-group">
						        <input type="text" class="form-control" id="voucherCode" name="voucherCode"
						               th:value="${session.voucher != null ? session.voucher.code : ''}" readonly
						               placeholder="Nh·∫≠p m√£/ ch·ªçn voucher" data-bs-toggle="modal" data-bs-target="#voucherModal">
						        <span class="input-group-text bg-primary text-white" data-bs-toggle="modal" data-bs-target="#voucherModal" style="cursor: pointer;">
						            <i class="fas fa-ticket-alt"></i>
						        </span>
						    </div>
						</div>
						<!-- Phi·∫øu mua h√†ng -->
						<div class="voucher-card-container" th:if="${session.voucher != null}">
						    <div class="voucher-card">
						        <!-- H√¨nh ·∫£nh th∆∞∆°ng hi·ªáu -->
						        <div class="voucher-image">
						            <img src="https://gigamall.com.vn/data/2024/05/10/14290213_shushiwa.jpg" alt="Voucher Sushi Wa">
						        </div>

						        <!-- Chi ti·∫øt voucher -->
						        <div class="voucher-details">
						            <h5 class="voucher-title">
						                <i class="fas fa-ticket-alt text-primary"></i>
						                <span th:text="${session.voucher.code}"></span>
						            </h5>
						            <p class="voucher-discount">
						                <span th:if="${session.voucher.discountType == 'AMOUNT'}">
						                    Gi·∫£m <strong th:text="${#numbers.formatInteger(session.voucher.discountAmount, 0, 'POINT')}"></strong> VND
						                </span>
						                <span th:if="${session.voucher.discountType == 'PERCENT'}">
						                    Gi·∫£m <strong th:text="${session.voucher.discountAmount}"></strong>%
						                    (T·ªëi ƒëa <strong th:text="${#numbers.formatInteger(session.voucher.maxDiscount, 0, 'POINT')}"></strong>‚Ç´)
						                </span>
						            </p>
						            <p class="voucher-expiry">
						                ƒê∆°n t·ªëi thi·ªÉu: <strong th:text="${#numbers.formatInteger(session.voucher.minOrderAmount, 0, 'POINT')}"></strong>‚Ç´<br>
						                HSD: <strong th:text="${#temporals.format(session.voucher.endDate, 'HH:mm dd/MM/yyyy')}"></strong>
						            </p>
						        </div>

								<!-- N√∫t h·ªßy + ƒêi·ªÅu ki·ªán -->
								<div class="voucher-actions d-flex flex-column h-100 align-items-end">
								    <!-- ƒê·∫©y n√∫t H·ªßy v√†o gi·ªØa -->
								    <div class="flex-grow-1 d-flex align-items-center">
								        <form th:action="@{/removeVoucher}" method="post">
								            <button type="submit" class="btn btn-outline-danger">H·ªßy</button>
								        </form>
								    </div>

								    <!-- N√∫t ƒêi·ªÅu ki·ªán (hi·ªÉn th·ªã modal) -->
								    <a href="#" class="mt-auto" data-bs-toggle="modal" data-bs-target="#voucherConditionModal">
								        ƒêi·ªÅu ki·ªán
								    </a>
								</div>
						    </div>
						</div>

						<!-- Modal hi·ªÉn th·ªã ƒëi·ªÅu ki·ªán -->
						<div class="modal fade" id="voucherConditionModal" tabindex="-1" aria-labelledby="voucherConditionLabel" aria-hidden="true">
						    <div class="modal-dialog modal-lg">
						        <div class="modal-content">
						            <div class="modal-header">
										<h4>	
							                <i class="fas fa-ticket-alt text-primary"></i>
							                <span th:text="${session.voucher != null ? session.voucher.code : 'Ch∆∞a √°p d·ª•ng voucher'}"></span>
							            </h4>						                
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">&times;</button>
						            </div>
						            <div class="modal-body">
						                <pre th:text="${session.voucher != null ? session.voucher.usageCondition : 'Kh√¥ng c√≥ th√¥ng tin ƒëi·ªÅu ki·ªán'}"></pre>
										<span th:if="${session.voucher != null and session.voucher.applicableToAll}">√Åp d·ª•ng cho: T·∫•t c·∫£ m√≥n ƒÉn</span>
										<div th:if="${session.voucher != null and !session.voucher.applicableToAll}" class="border p-3 rounded bg-white">
											<h5>M√≥n ƒÉn √°p d·ª•ng</h5>
					                          <div class="row">
					                              <div th:each="item : ${session.voucher.applicableItems}"  class="col-md-4 col-sm-6 mb-3">
													<div class="form-check d-flex align-items-center">
									                    <label th:for="'item-' + ${item.itemId}" class="form-check-label flex-grow-1 ml-2 d-flex align-items-center">
									                        <img th:src="${item.imageUrl}" alt="H√¨nh ·∫£nh m√≥n ƒÉn" class="rounded" 
									                             style="width: 50px; height: 50px; object-fit: cover; margin-right: 10px;" onclick="openModal(this)">
									                        <div>
									                            <span th:text="${item.name}"></span>
									                            <small class="text-muted d-block">(Gi√°: <span th:text="${#numbers.formatInteger(item.price, 0, 'POINT')}"></span> VND)</small>
																<form action="/add-to-cart" method="post" onsubmit="localStorage.setItem('scrollPosition', window.scrollY)">
																    <input type="hidden" name="id" th:value="${item.itemId}" />
																    <button type="submit" class="btn btn-xs btn-outline-primary px-2 py-1" style="font-size: 12px; height: 24px; line-height: 1;">
																        <i class="fas fa-cart-plus"></i>
																    </button>
																</form>
									                        </div>
									                    </label>
									                </div>
					                              </div>
					                          </div>
					                      </div>
						            </div>
						        </div>
						    </div>
						</div>
						<!-- Modal ƒëi·ªÅu ki·ªán s·ª≠ d·ª•ng (t·∫°o ri√™ng cho t·ª´ng voucher) -->
						<div th:each="userVoucher : ${savedVouchers}" th:id="'voucherConditionModal-' + ${userVoucher.voucher.code}" class="modal fade" tabindex="-1" aria-labelledby="voucherConditionLabel" aria-hidden="true">
						    <div class="modal-dialog modal-lg">
						        <div class="modal-content">
						            <div class="modal-header">
						                <h4>
						                    <i class="fas fa-ticket-alt text-primary"></i>
						                    <span th:text="${userVoucher.voucher.code}"></span>
						                </h4>
						                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">&times;</button>
						            </div>
						            <div class="modal-body">
						                <pre th:text="${userVoucher.voucher.usageCondition}"></pre>
						                <span th:if="${userVoucher.voucher.applicableToAll}">√Åp d·ª•ng cho: T·∫•t c·∫£ m√≥n ƒÉn</span>
						                <div th:if="${!userVoucher.voucher.applicableToAll}" class="border p-3 rounded bg-white">
						                    <h5>M√≥n ƒÉn √°p d·ª•ng</h5>
						                    <div class="row">
						                        <div th:each="item : ${userVoucher.voucher.applicableItems}" class="col-md-4 col-sm-6 mb-3">
						                            <div class="form-check d-flex align-items-center">
						                                <label class="form-check-label flex-grow-1 ml-2 d-flex align-items-center">
						                                    <img th:src="${item.imageUrl}" alt="H√¨nh ·∫£nh m√≥n ƒÉn" class="rounded" 
						                                         style="width: 50px; height: 50px; object-fit: cover; margin-right: 10px;">
						                                    <div>
						                                        <span th:text="${item.name}"></span>
						                                        <small class="text-muted d-block">(Gi√°: <span th:text="${#numbers.formatInteger(item.price, 0, 'POINT')}"></span> VND)</small>
						                                        <form action="/add-to-cart" method="post" onsubmit="localStorage.setItem('scrollPosition', window.scrollY)">
						                                            <input type="hidden" name="id" th:value="${item.itemId}" />
						                                            <button type="submit" class="btn btn-xs btn-outline-primary px-2 py-1" style="font-size: 12px; height: 24px; line-height: 1;">
						                                                <i class="fas fa-cart-plus"></i>
						                                            </button>
						                                        </form>
						                                    </div>
						                                </label>
						                            </div>
						                        </div>
						                    </div>
						                </div>
						            </div>
						        </div>
						    </div>  
						</div>
						<!-- Modal ch·ªçn voucher -->
						<div class="modal fade" id="voucherModal" tabindex="-1" aria-labelledby="voucherModalLabel" aria-hidden="true">
						    <div class="modal-dialog modal-lg">
						        <div class="modal-content">
						            <div class="modal-header">
						                <!-- M√£ voucher -->
						                <div class="align-items-center flex-grow-1">
						                    <form th:action="@{/applyVoucher}" method="post" class="d-flex flex-grow-1">
						                        <input type="text" class="form-control" id="voucherCode" placeholder="Nh·∫≠p m√£ voucher" name="voucherCode"
						                               th:value="${session.voucher != null ? session.voucher.code : ''}" required>
						                        <button type="submit" class="btn btn-sm btn-primary ms-2">√Åp d·ª•ng</button>
						                    </form>
						                </div>
						                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
						            </div>

						            <div class="modal-body">
						                <h5 class="modal-title fw-bold" id="voucherModalLabel">
						                    <i class="fas fa-ticket-alt"></i> Ch·ªçn Voucher Gi·∫£m Gi√°
						                </h5>

										<!-- Ki·ªÉm tra n·∫øu kh√¥ng c√≥ voucher h·ª£p l·ªá -->
										<div th:if="${#lists.isEmpty(savedVouchers)}" class="text-center text-muted">
										    <div>Kh√¥ng c√≥ voucher n√†o kh·∫£ d·ª•ng.</div>
										</div>

										<!-- Danh s√°ch voucher h·ª£p l·ªá -->
										<div th:if="${not #lists.isEmpty(savedVouchers)}">
										    <div class="voucher-list">
										        <div th:each="userVoucher : ${savedVouchers}" class="voucher-card">
										            <div class="voucher-details">
										                <h5 class="voucher-title">
										                    <i class="fas fa-ticket-alt text-warning"></i>
										                    <span th:text="${userVoucher.voucher.code}"></span>
										                </h5>
										                <p class="voucher-discount">
										                    <span th:if="${userVoucher.voucher.discountType == 'AMOUNT'}">
										                        Gi·∫£m <strong th:text="${#numbers.formatInteger(userVoucher.voucher.discountAmount, 0, 'COMMA')}"></strong> VND
										                    </span>
										                    <span th:if="${userVoucher.voucher.discountType == 'PERCENT'}">
										                        Gi·∫£m <strong th:text="${userVoucher.voucher.discountAmount}"></strong>%
										                        T·ªëi ƒëa <strong th:text="${userVoucher.voucher.maxDiscount}"></strong>‚Ç´
										                    </span>
										                </p>
										                <p class="voucher-expiry">
										                    ƒê∆°n h√†ng t·ªëi thi·ªÉu: <span th:text="${userVoucher.voucher.minOrderAmount}"></span>‚Ç´ <br>
										                    HSD: <span th:text="${userVoucher.voucher.endDate}"></span>
										                </p>
										                <a href="#" class="mt-auto" data-bs-toggle="modal" th:attr="data-bs-target='#voucherConditionModal-' + ${userVoucher.voucher.code}">
										                    ƒêi·ªÅu ki·ªán
										                </a>
										            </div>

										            <!-- N√∫t ch·ªçn voucher -->
										            <div class="voucher-actions">
										                <form th:action="@{/applyVoucher}" method="post">
										                    <input type="hidden" name="voucherCode" th:value="${userVoucher.voucher.code}">
										                    <button type="submit" class="btn btn-success">Ch·ªçn Voucher</button>
										                </form>
										            </div>
										        </div>
										    </div>
										</div>

						                <!-- N·∫øu ƒë√£ c√≥ voucher ƒë∆∞·ª£c ch·ªçn -->
						                <div class="voucher-card-container" th:if="${session.voucher != null}">
						                    <div class="voucher-card">
						                        <div class="voucher-details">
						                            <h5 class="voucher-title">
						                                <i class="fas fa-ticket-alt text-warning"></i>
						                                <span th:text="${session.voucher.code}"></span>
						                            </h5>
						                            <p class="voucher-discount">
						                                <span th:if="${session.voucher.discountType == 'AMOUNT'}">
						                                    Gi·∫£m <strong th:text="${#numbers.formatInteger(session.voucher.discountAmount, 0, 'COMMA')}"></strong> VND
						                                </span>
						                                <span th:if="${session.voucher.discountType == 'PERCENT'}">
						                                    Gi·∫£m <strong th:text="${session.voucher.discountAmount}"></strong>%
						                                    T·ªëi ƒëa <strong th:text="${session.voucher.maxDiscount}"></strong>‚Ç´
						                                </span>
						                            </p>
						                            <p class="voucher-expiry">
						                                ƒê∆°n h√†ng t·ªëi thi·ªÉu: <span th:text="${session.voucher.minOrderAmount}"></span>‚Ç´ <br>
						                                HSD: <span th:text="${session.voucher.endDate}"></span>
						                            </p>
						                        </div>

						                        <!-- N√∫t h·ªßy voucher -->
						                        <div class="voucher-actions">
						                            <form th:action="@{/removeVoucher}" method="post">
						                                <button type="submit" class="btn btn-danger">H·ªßy Voucher</button>
						                            </form>
						                        </div>
						                    </div>
						                </div>
						            </div>
						        </div>
						    </div>
						</div>

						<script>
						    document.addEventListener("DOMContentLoaded", function () {
						        document.querySelectorAll(".apply-voucher").forEach(button => {
						            button.addEventListener("click", function () {
						                let selectedVoucher = this.getAttribute("data-code");
						                document.getElementById("voucherCode").value = selectedVoucher;
						                let modal = new bootstrap.Modal(document.getElementById('voucherModal'));
						                modal.hide();
						            });
						        });
						    });
						</script>
					</div>
					<div class="container mt-3">
					    <!-- Hi·ªÉn th·ªã th√¥ng b√°o l·ªói -->
					    <div th:if="${errorMessage}" class="alert alert-danger">
					        <p th:utext="${errorMessage}"></p>
					    </div>

					    <!-- Hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng -->
					    <div th:if="${successMessage}" class="alert alert-success">
					        <p th:utext="${successMessage}"></p>
					    </div>
					</div>

					<div class="d-flex align-items-center">
						<small class="mb-3 text-danger">1 ƒëi·ªÉm = 500ƒë</small>
					</div>
				    <p><strong>T·ªïng gi√° tr·ªã gi·ªè h√†ng:</strong> <span th:text="${cartTotalFormatted}">0</span>ƒë</p>
				    <p><strong>D√πng ƒëi·ªÉm:</strong> <span th:text="${discountFromPoints}/500+' ƒëi·ªÉm '+'= '+${#numbers.formatInteger(discountFromPoints, 0, 'POINT')}"></span>ƒë</p>
				    <p><strong>Voucher:</strong> <span th:text="${#numbers.formatInteger(voucherDiscount, 0, 'POINT')}"></span> ƒë</p>
				    <p><strong>T·ªïng ti·ªÅn ph·∫£i thanh to√°n: <span class="text-danger" style="font-size: 20px;" th:text="${totalPayableFormatted}+'ƒë'">0</span></p></strong>
				</div>
			</div>

	        <div class="col-md-4 dashed-border-left">
	         
	                <h4>Th√¥ng Tin Nh·∫≠n H√†ng</h4>
					<form action="/processCheckout" id="paymentForm" method="post">
					    <hr>
					    <!-- C√°c th√¥ng tin thanh to√°n kh√°c -->
						<div class="mb-3">
						    <label for="fullname" class="form-label">Ng∆∞·ªùi nh·∫≠n h√†ng:</label>
						    <input type="text" class="form-control" id="fullname" name="fullname" th:value="${userName}" required>
						</div>
						<div class="mb-3">
						    <label for="phoneNumber" class="form-label">S·ªë ƒëi·ªán tho·∫°i:</label>
						    <input type="text" class="form-control" id="phoneNumber" name="phoneNumber" th:value="${phoneNumber}" required>
						</div>
						<!-- √î nh·∫≠p ƒë·ªãa ch·ªâ (Nh·∫•n v√†o ƒë·ªÉ m·ªü modal) -->
						<div class="mb-3">
						    <label for="address" class="form-label">ƒê·ªãa ch·ªâ giao h√†ng:</label>
						    <input type="text" class="form-control" id="address" name="address" th:value="${address}" required readonly 
						           data-bs-toggle="modal" data-bs-target="#updateInfoModal" style="cursor: pointer;">
						</div>

						<!-- N√∫t L·∫•y v·ªã tr√≠ hi·ªán t·∫°i -->
						<button type="button" class="btn btn-outline-primary mb-3" onclick="getCurrentLocation()">
						    üìç L·∫•y v·ªã tr√≠ hi·ªán t·∫°i
						</button>

						<!-- Modal C·∫≠p Nh·∫≠t ƒê·ªãa Ch·ªâ -->
						<div class="modal fade" id="updateInfoModal" tabindex="-1" aria-labelledby="updateInfoModalLabel" aria-hidden="true">
						    <div class="modal-dialog modal-lg">
						        <div class="modal-content">
						            <div class="modal-header">
						                <h5 class="modal-title">C·∫≠p nh·∫≠t ƒë·ªãa ch·ªâ nh·∫≠n h√†ng</h5>
						                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
						            </div>

						            <div class="modal-body">
						                <div class="row mb-3">
						                    <div class="col-md-3">
						                        <label for="city" class="form-label">Th√†nh ph·ªë:</label>
						                        <select class="form-control" id="city" required>
						                            <option value="">Ch·ªçn th√†nh ph·ªë</option>
						                            <option value="H·ªì Ch√≠ Minh">H·ªì Ch√≠ Minh</option>
						                        </select>
						                    </div>
						                    <div class="col-md-3">
						                        <label for="district" class="form-label">Qu·∫≠n/Huy·ªán:</label>
						                        <select class="form-control" id="district" required>
						                            <option value="">Ch·ªçn qu·∫≠n/huy·ªán</option>
						                        </select>
						                    </div>
						                    <div class="col-md-3">
						                        <label for="ward" class="form-label">Ph∆∞·ªùng/X√£:</label>
						                        <select class="form-control" id="ward" required>
						                            <option value="">Ch·ªçn ph∆∞·ªùng/x√£</option>
						                        </select>
						                    </div>
						                    <div class="col-md-3">
						                        <label for="street" class="form-label">ƒê∆∞·ªùng:</label>
						                        <select class="form-control" id="street" required>
						                            <option value="">Ch·ªçn ƒë∆∞·ªùng</option>
						                        </select>
						                    </div>
						                </div>

						                <div class="row mb-3">
						                    <div class="col-md-12">
						                        <label for="houseNumber" class="form-label">S·ªë nh√†:</label>
						                        <input type="text" class="form-control" id="houseNumber" placeholder="Nh·∫≠p s·ªë nh√†" required>
						                    </div>
						                </div>
						            </div>

						            <div class="modal-footer">
						                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
						                <button type="button" class="btn btn-primary" onclick="updateAddress()">C·∫≠p nh·∫≠t</button>
						            </div>
						        </div>
						    </div>
						</div>

						<script>
						    function getCurrentLocation() {
						        if (navigator.geolocation) {
						            navigator.geolocation.getCurrentPosition(
						                async (position) => {
						                    const lat = position.coords.latitude;
						                    const lng = position.coords.longitude;

						                    // G·ªçi API Nominatim c·ªßa OpenStreetMap ƒë·ªÉ l·∫•y ƒë·ªãa ch·ªâ t·ª´ t·ªça ƒë·ªô
						                    const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`;

						                    try {
						                        const response = await fetch(url);
						                        const data = await response.json();
						                        if (data && data.address) {
						                            const address = data.address;

						                            // ƒêi·ªÅn d·ªØ li·ªáu v√†o modal
						                            document.getElementById("city").value = "H·ªì Ch√≠ Minh"; // C·ªë ƒë·ªãnh TP HCM
						                            document.getElementById("district").value = address.suburb || address.city_district || "";
						                            document.getElementById("ward").value = address.village || address.town || address.city || "";
						                            document.getElementById("street").value = address.road || "";
						                            document.getElementById("houseNumber").value = address.house_number || "";

						                            // Hi·ªÉn th·ªã ƒë·ªãa ch·ªâ tr√™n input ch√≠nh
						                            document.getElementById("address").value = `${address.house_number || ""}, ${address.road || ""}, ${address.village || address.town || address.city || ""}, ${address.suburb || address.city_district || ""}, H·ªì Ch√≠ Minh`;

						                            // Hi·ªÉn th·ªã modal c·∫≠p nh·∫≠t ƒë·ªãa ch·ªâ
						                            new bootstrap.Modal(document.getElementById("updateInfoModal")).show();
						                        } else {
						                            alert("Kh√¥ng t√¨m th·∫•y ƒë·ªãa ch·ªâ t·ª´ t·ªça ƒë·ªô!");
						                        }
						                    } catch (error) {
						                        console.error("L·ªói khi l·∫•y ƒë·ªãa ch·ªâ:", error);
						                        alert("L·ªói khi l·∫•y v·ªã tr√≠, vui l√≤ng th·ª≠ l·∫°i!");
						                    }
						                },
						                (error) => {
						                    let message = "Kh√¥ng th·ªÉ l·∫•y v·ªã tr√≠, vui l√≤ng b·∫≠t GPS v√† th·ª≠ l·∫°i!";
						                    if (error.code === error.PERMISSION_DENIED) {
						                        message = "B·∫°n ƒë√£ t·ª´ ch·ªëi quy·ªÅn truy c·∫≠p v·ªã tr√≠. H√£y b·∫≠t GPS v√† c·∫•p quy·ªÅn cho trang web!";
						                    } else if (error.code === error.POSITION_UNAVAILABLE) {
						                        message = "Kh√¥ng th·ªÉ l·∫•y v·ªã tr√≠ c·ªßa b·∫°n, h√£y ki·ªÉm tra GPS tr√™n thi·∫øt b·ªã!";
						                    } else if (error.code === error.TIMEOUT) {
						                        message = "L·∫•y v·ªã tr√≠ qu√° l√¢u, vui l√≤ng th·ª≠ l·∫°i!";
						                    }
						                    alert(message);
						                }
						            );
						        } else {
						            alert("Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ l·∫•y v·ªã tr√≠!");
						        }
						    }
						</script>


						<!-- Script c·∫≠p nh·∫≠t ƒë·ªãa ch·ªâ -->
						<script>
							const districtsData = {
							    "H·ªì Ch√≠ Minh": [
							        "Th√†nh ph·ªë Th·ªß ƒê·ª©c", "Qu·∫≠n B√¨nh Th·∫°nh", "Qu·∫≠n G√≤ V·∫•p", "Qu·∫≠n 12", "Qu·∫≠n T√¢n B√¨nh", "Qu·∫≠n Ph√∫ Nhu·∫≠n"
							    ]
							};

							const wardsData = {
							    "Th√†nh ph·ªë Th·ªß ƒê·ª©c": [
							        "Ph∆∞·ªùng Hi·ªáp B√¨nh Ch√°nh", "Ph∆∞·ªùng Hi·ªáp B√¨nh Ph∆∞·ªõc", "Ph∆∞·ªùng Linh ƒê√¥ng", "Ph∆∞·ªùng Linh T√¢y", "Ph∆∞·ªùng Linh Trung", 
							        "Ph∆∞·ªùng Linh Chi·ªÉu", "Ph∆∞·ªùng Tr∆∞·ªùng Th·ªç", "Ph∆∞·ªùng B√¨nh Th·ªç", "Ph∆∞·ªùng Tam Ph√∫", "Ph∆∞·ªùng Tam B√¨nh"
							    ],
							    "Qu·∫≠n B√¨nh Th·∫°nh": [
							        "Ph∆∞·ªùng 11", "Ph∆∞·ªùng 12", "Ph∆∞·ªùng 13", "Ph∆∞·ªùng 14", "Ph∆∞·ªùng 15", "Ph∆∞·ªùng 17", "Ph∆∞·ªùng 19", "Ph∆∞·ªùng 21", "Ph∆∞·ªùng 22", "Ph∆∞·ªùng 24"
							    ],
							    "Qu·∫≠n G√≤ V·∫•p": [
							        "Ph∆∞·ªùng 1", "Ph∆∞·ªùng 3", "Ph∆∞·ªùng 4", "Ph∆∞·ªùng 5", "Ph∆∞·ªùng 6", "Ph∆∞·ªùng 7", "Ph∆∞·ªùng 8", "Ph∆∞·ªùng 9", "Ph∆∞·ªùng 10", "Ph∆∞·ªùng 11"
							    ],
							    "Qu·∫≠n 12": [
							        "Ph∆∞·ªùng An Ph√∫ ƒê√¥ng", "Ph∆∞·ªùng ƒê√¥ng H∆∞ng Thu·∫≠n", "Ph∆∞·ªùng Hi·ªáp Th√†nh", "Ph∆∞·ªùng T√¢n Ch√°nh Hi·ªáp", "Ph∆∞·ªùng T√¢n H∆∞ng Thu·∫≠n", 
							        "Ph∆∞·ªùng T√¢n Th·ªõi Hi·ªáp", "Ph∆∞·ªùng T√¢n Th·ªõi Nh·∫•t", "Ph∆∞·ªùng Th·∫°nh L·ªôc", "Ph∆∞·ªùng Th·∫°nh Xu√¢n", "Ph∆∞·ªùng Th·ªõi An"
							    ]
							};

							const streetsData = {
							    "Th√†nh ph·ªë Th·ªß ƒê·ª©c": {
							        "Ph∆∞·ªùng Hi·ªáp B√¨nh Ch√°nh": [
							            "Ph·∫°m VƒÉn ƒê·ªìng", "Kha V·∫°n C√¢n", "Hi·ªáp B√¨nh", "Tam B√¨nh", "ƒê·∫∑ng VƒÉn Bi", "Nguy·ªÖn VƒÉn B√°", "V√µ VƒÉn Ng√¢n", "T√¥ Ng·ªçc V√¢n", "Ho√†ng Di·ªáu 2", "Linh Trung"
							        ],
							        "Ph∆∞·ªùng Hi·ªáp B√¨nh Ph∆∞·ªõc": [
							            "Qu·ªëc l·ªô 13", "Hi·ªáp B√¨nh", "ƒê∆∞·ªùng s·ªë 23", "ƒê∆∞·ªùng s·ªë 25", "ƒê∆∞·ªùng s·ªë 27", "ƒê∆∞·ªùng s·ªë 29", "ƒê∆∞·ªùng s·ªë 31", "ƒê∆∞·ªùng s·ªë 33", "ƒê∆∞·ªùng s·ªë 35", "ƒê∆∞·ªùng s·ªë 37"
							        ],
							        "Ph∆∞·ªùng Linh ƒê√¥ng": [
							            "T√¥ Ng·ªçc V√¢n", "Ph·∫°m VƒÉn ƒê·ªìng", "ƒê∆∞·ªùng s·ªë 8", "ƒê∆∞·ªùng s·ªë 10", "ƒê∆∞·ªùng s·ªë 20", "ƒê∆∞·ªùng s·ªë 22", "ƒê∆∞·ªùng s·ªë 24", "ƒê∆∞·ªùng s·ªë 26", "ƒê∆∞·ªùng s·ªë 28", "ƒê∆∞·ªùng s·ªë 30"
							        ],
							        "Ph∆∞·ªùng Linh T√¢y": [
							            "ƒê·∫∑ng VƒÉn Bi", "Ho√†ng Di·ªáu 2", "Kha V·∫°n C√¢n", "V√µ VƒÉn Ng√¢n", "Nguy·ªÖn VƒÉn B√°", "T√¥ Ng·ªçc V√¢n", "Linh Trung", "D∆∞∆°ng ƒê√¨nh H·ªôi", "ƒê∆∞·ªùng s·ªë 17", "ƒê∆∞·ªùng s·ªë 19"
							        ],
							        "Ph∆∞·ªùng Linh Trung": [
							            "L√™ VƒÉn Ch√≠", "Xa l·ªô H√† N·ªôi", "ƒê∆∞·ªùng s·ªë 6", "ƒê∆∞·ªùng s·ªë 8", "ƒê∆∞·ªùng s·ªë 10", "ƒê∆∞·ªùng s·ªë 12", "ƒê∆∞·ªùng s·ªë 14", "ƒê∆∞·ªùng s·ªë 16", "ƒê∆∞·ªùng s·ªë 18", "ƒê∆∞·ªùng s·ªë 20"
							        ]
							    },
							    "Qu·∫≠n B√¨nh Th·∫°nh": {
							        "Ph∆∞·ªùng 11": [
							            "ƒêi·ªán Bi√™n Ph·ªß", "Nguy·ªÖn H·ªØu C·∫£nh", "X√¥ Vi·∫øt Ngh·ªá Tƒ©nh", "B·∫°ch ƒê·∫±ng", "Ung VƒÉn Khi√™m", "Ho√†ng Hoa Th√°m", "L√™ Quang ƒê·ªãnh", "Phan ƒêƒÉng L∆∞u", "D2", "D3"
							        ],
							        "Ph∆∞·ªùng 12": [
							            "B·∫°ch ƒê·∫±ng", "X√¥ Vi·∫øt Ngh·ªá Tƒ©nh", "ƒêinh B·ªô Lƒ©nh", "Chu VƒÉn An", "L√™ Tr·ª±c", "Nguy·ªÖn VƒÉn ƒê·∫≠u", "Phan X√≠ch Long", "Ho√†ng VƒÉn Th·ª•", "Tr·∫ßn K·∫ø X∆∞∆°ng", "Nguy·ªÖn C√¥ng Hoan"
							        ],
							        "Ph∆∞·ªùng 13": [
							            "Nguy·ªÖn X√≠", "ƒêinh B·ªô Lƒ©nh", "N∆° Trang Long", "Phan VƒÉn Tr·ªã", "Nguy·ªÖn Huy L∆∞·ª£ng", "Phan Chu Trinh", "Nguy·ªÖn C√¥ng Hoan", "ƒê∆∞·ªùng D1", "ƒê∆∞·ªùng D2", "ƒê∆∞·ªùng D3"
							        ]
							    },
							    "Qu·∫≠n G√≤ V·∫•p": {
							        "Ph∆∞·ªùng 1": [
							            "Nguy·ªÖn Oanh", "Nguy·ªÖn VƒÉn Nghi", "Phan VƒÉn Tr·ªã", "L√™ Quang ƒê·ªãnh", "Quang Trung", "D∆∞∆°ng Qu·∫£ng H√†m", "Th·ªëng Nh·∫•t", "Nguy·ªÖn Ki·ªám", "L√™ ƒê·ª©c Th·ªç", "Ph·∫°m VƒÉn Chi√™u"
							        ],
									"Ph∆∞·ªùng 5": [
							            "Nguy·ªÖn Th√°i S∆°n"
							        ],
							        "Ph∆∞·ªùng 12": [
							            "Quang Trung", "L√™ VƒÉn Th·ªç", "Nguy·ªÖn VƒÉn L∆∞·ª£ng", "Th·ªëng Nh·∫•t", "Ph·∫°m VƒÉn B·∫°ch", "D∆∞∆°ng Qu·∫£ng H√†m", "Nguy·ªÖn T∆∞ Gi·∫£n", "L√Ω Th∆∞·ªùng Ki·ªát", "Tr·∫ßn Th·ªã Nghƒ©", "Phan Huy √çch"
							        ]
							    },
							    "Qu·∫≠n 12": {
							        "Ph∆∞·ªùng An Ph√∫ ƒê√¥ng": [
							            "H√† Huy Gi√°p", "V∆∞·ªùn L√†i", "Nguy·ªÖn Th·ªã ƒê·∫∑ng", "Nguy·ªÖn ·∫¢nh Th·ªß", "ƒê∆∞·ªùng TX25", "ƒê∆∞·ªùng TX21", "ƒê∆∞·ªùng TX19", "ƒê∆∞·ªùng TX17", "ƒê∆∞·ªùng TX15", "ƒê∆∞·ªùng TX13"
							        ],
							        "Ph∆∞·ªùng ƒê√¥ng H∆∞ng Thu·∫≠n": [
							            "Nguy·ªÖn VƒÉn Qu√°", "T√¥ K√Ω", "Tr∆∞·ªùng Chinh", "Quang Trung", "Song H√†nh", "L√™ Th·ªã Ri√™ng", "ƒê∆∞·ªùng s·ªë 2", "ƒê∆∞·ªùng s·ªë 4", "ƒê∆∞·ªùng s·ªë 6", "ƒê∆∞·ªùng s·ªë 8"
							        ],
							        "Ph∆∞·ªùng T√¢n Ch√°nh Hi·ªáp": [
							            "T√¥ K√Ω", "Nguy·ªÖn ·∫¢nh Th·ªß", "D∆∞∆°ng Th·ªã M∆∞·ªùi", "Song H√†nh", "L√™ VƒÉn Kh∆∞∆°ng", "ƒê∆∞·ªùng s·ªë 1", "ƒê∆∞·ªùng s·ªë 3", "ƒê∆∞·ªùng s·ªë 5", "ƒê∆∞·ªùng s·ªë 7", "ƒê∆∞·ªùng s·ªë 9"
							        ]
							    },
							    "Qu·∫≠n T√¢n B√¨nh": {
							        "Ph∆∞·ªùng 2": [
							            "Tr∆∞·ªùng S∆°n", "C·ªông H√≤a", "Ho√†ng VƒÉn Th·ª•", "Phan ƒê√¨nh Gi√≥t", "L√Ω Th∆∞·ªùng Ki·ªát", "ƒê∆∞·ªùng ·∫§p B·∫Øc", "Tr·∫ßn Qu·ªëc Ho√†n", "H·ªìng H√†", "Nguy·ªÖn S·ªπ S√°ch", "T√¢n S∆°n Nh√¨"
							        ],
							        "Ph∆∞·ªùng 4": [
							            "Ho√†ng VƒÉn Th·ª•", "Tr·∫ßn Qu·ªëc Ho√†n", "C·ªông H√≤a", "L√™ VƒÉn S·ªπ", "Nguy·ªÖn Th√°i B√¨nh", "Nguy·ªÖn Tr·ªçng Tuy·ªÉn", "Tr·∫ßn H∆∞ng ƒê·∫°o", "ƒê·ªìng ƒêen", "L·∫°c Long Qu√¢n", "Ph·∫°m VƒÉn Hai"
							        ]
							    },
							    "Qu·∫≠n Ph√∫ Nhu·∫≠n": {
							        "Ph∆∞·ªùng 9": [
							            "Phan ƒêƒÉng L∆∞u", "Phan X√≠ch Long", "Nguy·ªÖn Ki·ªám", "Tr·∫ßn H·ªØu Trang", "ƒê√†o Duy Anh", "Ho√†ng VƒÉn Th·ª•", "Nguy·ªÖn ƒê√¨nh Chi·ªÉu", "L√™ VƒÉn S·ªπ", "Tr∆∞·ªùng Sa", "Ho√†ng Sa"
							        ],
							        "Ph∆∞·ªùng 15": [
							            "Nguy·ªÖn VƒÉn Tr·ªói", "Hu·ª≥nh VƒÉn B√°nh", "Phan ƒê√¨nh Ph√πng", "Ho√†ng VƒÉn Th·ª•", "Nguy·ªÖn Ki·ªám", "Tr·∫ßn Quang Kh·∫£i", "Tr∆∞·ªùng Sa", "Tr·∫ßn H∆∞ng ƒê·∫°o", "L√Ω Ch√≠nh Th·∫Øng", "Phan X√≠ch Long"
							        ]
							    }
							};
							// DOM Elements
							const citySelect = document.getElementById("city");
							const districtSelect = document.getElementById("district");
							const wardSelect = document.getElementById("ward");
							const streetSelect = document.getElementById("street");

							// H√†m c·∫≠p nh·∫≠t options cho select
							function updateSelectOptions(selectElement, options, placeholder) {
							    selectElement.innerHTML = `<option value="">${placeholder}</option>`;
							    if (options && options.length) {
							        options.forEach(option => {
							            selectElement.innerHTML += `<option value="${option}">${option}</option>`;
							        });
							        selectElement.disabled = false;
							    } else {
							        selectElement.disabled = true;
							    }
							}

							// Ch·ªçn Th√†nh Ph·ªë ‚Üí Hi·ªÉn th·ªã Qu·∫≠n/Huy·ªán
							citySelect.addEventListener("change", function () {
							    const selectedCity = citySelect.value;
							    resetSelect(districtSelect);
							    resetSelect(wardSelect);
							    resetSelect(streetSelect);
							    
							    if (selectedCity && districtsData[selectedCity]) {
							        updateSelectOptions(districtSelect, districtsData[selectedCity], "Ch·ªçn qu·∫≠n/huy·ªán");
							    }
							});

							// Ch·ªçn Qu·∫≠n/Huy·ªán ‚Üí Hi·ªÉn th·ªã Ph∆∞·ªùng/X√£
							districtSelect.addEventListener("change", function () {
							    const selectedDistrict = districtSelect.value;
							    resetSelect(wardSelect);
							    resetSelect(streetSelect);
							    
							    if (selectedDistrict && wardsData[selectedDistrict]) {
							        updateSelectOptions(wardSelect, wardsData[selectedDistrict], "Ch·ªçn ph∆∞·ªùng/x√£");
							    }
							});

							// Ch·ªçn Ph∆∞·ªùng/X√£ ‚Üí Hi·ªÉn th·ªã ƒê∆∞·ªùng
							wardSelect.addEventListener("change", function () {
							    const selectedDistrict = districtSelect.value;
							    const selectedWard = wardSelect.value;
							    resetSelect(streetSelect);

							    if (selectedDistrict && selectedWard && streetsData[selectedDistrict] && streetsData[selectedDistrict][selectedWard]) {
							        updateSelectOptions(streetSelect, streetsData[selectedDistrict][selectedWard], "Ch·ªçn ƒë∆∞·ªùng");
							    }
							});

							// Reset Select (gi·ªØ l·∫°i placeholder)
							function resetSelect(selectElement) {
							    selectElement.innerHTML = `<option value="">Ch·ªçn</option>`;
							    selectElement.disabled = true;
							}

							function updateAddress() {
							    let city = document.getElementById("city").value;
							    let district = document.getElementById("district").value;
							    let ward = document.getElementById("ward").value;
							    let street = document.getElementById("street").value;
							    let houseNumber = document.getElementById("houseNumber").value;

							    if (!city || !district || !ward || !street || !houseNumber) {
							        alert("Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!");
							        return;
							    }

							    let fullAddress = `${houseNumber}, ${street}, ${ward}, ${district}, ${city}`;
							    document.getElementById("address").value = fullAddress;

							    // L·∫•y modal hi·ªán t·∫°i v√† ·∫©n n√≥
							    let modalElement = document.getElementById("updateInfoModal");
							    let modalInstance = bootstrap.Modal.getInstance(modalElement);
							    if (modalInstance) {
							        modalInstance.hide();
							    }
							}

						</script>

						<div class="mb-3 ">
						    <label for="deliveryTime" class="col-4 form-label">Gi·ªù giao h√†ng:</label>
						    <input type="datetime-local" class="form-control" id="deliveryTime" name="deliveryDate" required>
						</div>
						<small id="error-message" style="color: red; display: none;">Vui l√≤ng ch·ªçn th·ªùi gian h·ª£p l·ªá!</small>

						<script>
						document.addEventListener("DOMContentLoaded", function () {
						    const deliveryTimeInput = document.getElementById("deliveryTime");
						    const errorMessage = document.getElementById("error-message");

						    function setMinMaxDeliveryTime() {
						        const now = new Date();
						        now.setMinutes(now.getMinutes() + 1); // Kh√¥ng cho ph√©p ch·ªçn th·ªùi gian trong qu√° kh·ª©

						        let year = now.getFullYear();
						        let month = String(now.getMonth() + 1).padStart(2, "0");
						        let day = String(now.getDate()).padStart(2, "0");
						        let hours = String(now.getHours()).padStart(2, "0");
						        let minutes = String(now.getMinutes()).padStart(2, "0");

						        // N·∫øu gi·ªù hi·ªán t·∫°i qu√° tr·ªÖ (sau 22:00), chuy·ªÉn sang ng√†y mai
						        if (now.getHours() >= 22) {
						            now.setDate(now.getDate() + 1);
						        }
						        
						        // Ng√†y mai
						        const tomorrow = new Date(now);
						        tomorrow.setDate(tomorrow.getDate() + 1);
						        const tomorrowYear = tomorrow.getFullYear();
						        const tomorrowMonth = String(tomorrow.getMonth() + 1).padStart(2, "0");
						        const tomorrowDay = String(tomorrow.getDate()).padStart(2, "0");

						        // Gi·ªõi h·∫°n ng√†y ƒë∆∞·ª£c ch·ªçn (ch·ªâ h√¥m nay ho·∫∑c ng√†y mai)
						        const minDateTime = `${year}-${month}-${day}T${hours}:${minutes}`;
						        const maxDateTime = `${tomorrowYear}-${tomorrowMonth}-${tomorrowDay}T23:59`;

						        deliveryTimeInput.min = minDateTime; // Gi·ªõi h·∫°n th·ªùi gian t·ªëi thi·ªÉu
						        deliveryTimeInput.max = maxDateTime; // Gi·ªõi h·∫°n th·ªùi gian t·ªëi ƒëa
						        deliveryTimeInput.value = minDateTime; // ƒê·∫∑t gi√° tr·ªã m·∫∑c ƒë·ªãnh
						    }

						    setMinMaxDeliveryTime();

						    // Ki·ªÉm tra khi ng∆∞·ªùi d√πng ch·ªçn th·ªùi gian
						    deliveryTimeInput.addEventListener("input", function () {
						        const selectedDate = new Date(deliveryTimeInput.value);
						        const now = new Date();
						        now.setMinutes(now.getMinutes() + 1);

						        // T·∫°o ng√†y h√¥m nay v√† ng√†y mai ƒë·ªÉ so s√°nh
						        const today = new Date();
						        const tomorrow = new Date();
						        tomorrow.setDate(tomorrow.getDate() + 1);

						        // Ch·ªâ cho ph√©p ch·ªçn h√¥m nay ho·∫∑c ng√†y mai
						        if (selectedDate.toDateString() !== today.toDateString() && selectedDate.toDateString() !== tomorrow.toDateString()) {
						            errorMessage.textContent = "Ch·ªâ c√≥ th·ªÉ ch·ªçn ng√†y h√¥m nay ho·∫∑c ng√†y mai!";
						            errorMessage.style.display = "block";
						            deliveryTimeInput.value = "";
						            return;
						        }

						        // N·∫øu ch·ªçn ng√†y h√¥m nay, gi·ªù ph·∫£i l·ªõn h∆°n hi·ªán t·∫°i
						        if (selectedDate.toDateString() === today.toDateString() && selectedDate < now) {
						            errorMessage.textContent = "Gi·ªù giao h√†ng ph·∫£i sau th·ªùi ƒëi·ªÉm hi·ªán t·∫°i!";
						            errorMessage.style.display = "block";
						            deliveryTimeInput.value = "";
						        } else {
						            errorMessage.style.display = "none"; // ·∫®n th√¥ng b√°o n·∫øu h·ª£p l·ªá
						        }
						    });
						});
						</script>

						<div class="mb-3 d-flex">
						    <label for="paymentMethod" class="col-4 form-label">PT thanh to√°n:</label>
						    <select class="form-select" id="paymentMethod" name="paymentMethod" onchange="confirmVietQR(this)" required>
						        <option value="" selected>Ch·ªçn h√¨nh th·ª©c thanh to√°n</option> <!-- M·ª•c m·∫∑c ƒë·ªãnh -->
						        <option value="momo">MoMo</option>
						        <option value="vietqr">Chuy·ªÉn kho·∫£n VietQR Pro</option>
						        <option value="cod">Thanh to√°n khi nh·∫≠n h√†ng</option>
						    </select>
						</div>
						<div class="mb-3 d-flex">
							<label for="note" class="form-label">Ghi ch√∫:</label>
					        <input type="text" class="form-control" id="note" name="note">
						</div>

						<button type="submit" id="submitBtn" class="btn btn-primary w-100">
						    Thanh to√°n <i class="fas fa-hand-holding-usd"></i>
						</button>					
					</form>
	            </div>
	        </div>
	    </div>
	</div>

	<script>
		function confirmVietQR(selectElement) {
		    let totalPayable = parseInt(document.getElementById("totalPayable").textContent.replace(/\D/g, ""), 10);

		    // Ki·ªÉm tra s·ªë ti·ªÅn ph·∫£i tr√™n 2000ƒë
		    if (selectElement.value === "vietqr") {
		        if (totalPayable < 2000) {
		            alert("ƒê·ªÉ s·ª≠ d·ª•ng VietQR PRO, gi√° tr·ªã ƒë∆°n h√†ng ph·∫£i tr√™n 2.000ƒë!");
		            selectElement.value = ""; // Reset v·ªÅ m·∫∑c ƒë·ªãnh
		            return;
		        }

		        // Hi·ªÉn th·ªã x√°c nh·∫≠n tr∆∞·ªõc khi t·∫°o m√£ QR
		        let confirmPayment = confirm("B·∫°n ƒëang ch·ªçn thanh to√°n b·∫±ng VietQR. M√£ QR s·∫Ω ƒë∆∞·ª£c t·∫°o. B·∫°n c√≥ ch·∫Øc ch·∫Øn kh√¥ng?");
		        if (!confirmPayment) {
		            selectElement.value = ""; // N·∫øu ng∆∞·ªùi d√πng b·∫•m "H·ªßy", reset l·∫°i l·ª±a ch·ªçn
		        }
		    }
		}
	</script>
	<!-- Modal -->
	<div class="modal fade" id="loadingModal" tabindex="-1" aria-labelledby="loadingModalLabel" aria-hidden="true">
	    <div class="modal-dialog d-flex justify-content-center align-items-center">
	        <div class="modal-content">
	            <div class="modal-body">
	                <!-- Thanh ti·∫øn tr√¨nh -->
	                <div class="progress">
	                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%;" id="progressBar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
	                </div>
	                <div class="text-center mt-2">
	                    ƒê∆°n h√†ng ƒëang ƒë∆∞·ª£c g·ª≠i ƒëi, vui l√≤ng ch·ªù...
	                </div>
	                <div class="text-center mt-1">
	                    <span id="progressPercent">0%</span>
	                </div>
	            </div>
	        </div>
	    </div>
	</div>

	<!-- Modal Momo QR -->
	<div class="modal fade" id="momoQrModal" tabindex="-1" aria-labelledby="momoQrModalLabel" aria-hidden="true">
	    <div class="modal-dialog modal-dialog-centered modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
	            </div>
	            <div class="modal-body text-center">
					<h4 class="modal-title">Qu√©t m√£ QR ƒë·ªÉ thanh to√°n</h4>

					<img id="momoQrImage"
					     th:src="@{'https://img.vietqr.io/image/VCCB-99MM24740M35863683-qr_only.png?amount=' + ${#numbers.formatInteger(totalPayable, 0)} + '&addInfo=SSW-69319491160&accountName=Huynh%20Thanh%20Phat'}"
					     alt="M√£ QR MoMo"
					     class="img-fluid"
					     style="max-width: 50%;">
						 <td colspan="2">
                            <div class="text-success" id="orderValidity">
                                <p class="text-danger">Vui l√≤ng d√πng ·ª©ng d·ª•ng <img src="https://cdn.haitrieu.com/wp-content/uploads/2022/10/Logo-MoMo-Square.png" width="30px" alt=""> ƒë·ªÉ qu√©t m√£ thanh to√°n</p>
								<div id="countdownWrapper">
								    M√£ QR c√≥ hi·ªáu l·ª±c trong: <span id="countdown">30</span> gi√¢y
								</div>
                            </div>
                            <div class="d-none text-danger" id="Thanhtoanthatbai">Thanh to√°n th·∫•t b·∫°i do qu√° th·ªùi gian hi·ªáu l·ª±c c·ªßa m√£ QR.</div>
							<script>
							    let countdown = 150; // Th·ªùi gian ƒë·∫øm ng∆∞·ª£c
							    const countdownElement = document.getElementById("countdown");
							    const countdownWrapper = document.getElementById("countdownWrapper"); // Th√™m d√≤ng n√†y
							    const failedMessage = document.getElementById("Thanhtoanthatbai");

							    function updateCountdown() {
							        if (countdown > 0) {
							            countdown--; // Gi·∫£m 1 gi√¢y
							            countdownElement.textContent = countdown; // C·∫≠p nh·∫≠t giao di·ªán
							        } else {
							            countdownWrapper.classList.add("d-none"); // ·∫®n to√†n b·ªô d√≤ng ch·ª©a ƒë·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c
							            failedMessage.classList.remove("d-none"); // Hi·ªÉn th·ªã th√¥ng b√°o th·∫•t b·∫°i
							            setTimeout(() => {
							                location.reload(); // Reload trang sau 2 gi√¢y
							            }, 5000);
							        }
							    }

							    setInterval(updateCountdown, 1000); // G·ªçi updateCountdown m·ªói gi√¢y
							</script>


                        </td>
	            </div>
				<p><strong>T·ªïng ti·ªÅn ph·∫£i thanh to√°n: <span class="text-danger text-align" style="font-size: 20px;" th:text="${totalPayableFormatted}+'ƒë'">0</span></p></strong>
				<button type="button" class="btn-primary mb-2" width="100%" data-bs-dismiss="modal" aria-label="Close">T√îI ƒê√É THANH TO√ÅN</button>

			 </div>
	    </div>
	</div>
	<div class="modal fade" id="voucherUsageModal" tabindex="-1" role="dialog" aria-labelledby="voucherUsageModalLabel" aria-hidden="true">
	    <div class="modal-dialog" role="document">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h5 class="modal-title" id="voucherUsageModalLabel">ƒêi·ªÅu Ki·ªán S·ª≠ D·ª•ng Voucher</h5>
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	                    <span aria-hidden="true">&times;</span>
	                </button>
	            </div>
	            <div class="modal-body">
	                <p th:text="${session.voucher != null ? session.voucher.usageCondition : 'Kh√¥ng c√≥ th√¥ng tin ƒëi·ªÅu ki·ªán'}"></p>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-secondary" data-dismiss="modal">ƒê√≥ng</button>
	            </div>
	        </div>
	    </div>
	</div>
	
	<script>
	    document.addEventListener("DOMContentLoaded", function () {
	        let errorMessage = document.querySelector(".alert-danger");
	        if (errorMessage && errorMessage.innerHTML.includes("Xem ƒëi·ªÅu ki·ªán s·ª≠ d·ª•ng")) {
	            new bootstrap.Modal(document.getElementById("voucherUsageModal")).show();
	        }
	    });
	</script>

	<!-- Modal Viet QR -->
	<div class="modal fade" id="vietQrModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false" aria-labelledby="vietQrModalLabel" aria-hidden="true">
		<div class="modal-overlay"></div> <!-- L·ªõp ph·ªß -->
	    <div class="modal-dialog modal-dialog-centered" style="max-width: 500px;">
	        <div class="modal-content" style="border-radius: 15px; background-color: #1D2453; color: white; text-align: center; padding: 20px;">
				<div class="modal-header border-0 d-flex flex-column">
				    <h4 class="modal-title" style="color: #FFC107;">
				        M√£ QR thanh to√°n t·ª± ƒë·ªông
				    </h4>
				    <p class="text-light" style="font-size: 12px;">
				        (X√°c nh·∫≠n t·ª± ƒë·ªông - Th∆∞·ªùng kh√¥ng qu√° 3s)
				    </p>
				</div>
	            <span id="orderCode" th:text="${orderCode}" hidden></span>
	            <span id="totalPayable" th:text="${#numbers.formatInteger(totalPayable, 0)}" hidden></span>

	            <div class="modal-body">
					<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="" height="" viewBox="0 0 1370 68" fill="none" hidden>
					CH·ªÆ VIETQR
					<g xmlns="http://www.w3.org/2000/svg" clip-path="url(#clip0_8273_43719)">
					        <path d="M42.6695 29.9766C43.2281 29.9769 43.7637 30.2003 44.1585 30.5975C44.5533 30.9947 44.7751 31.5333 44.7751 32.0948V48.1522C44.7751 48.7136 44.5533 49.252 44.1584 49.649C43.7635 50.046 43.228 50.269 42.6695 50.269C42.1109 50.269 41.5752 50.0461 41.1801 49.6491C40.785 49.2522 40.5629 48.7137 40.5625 48.1522V32.0948C40.5629 31.5331 40.785 30.9946 41.18 30.5974C41.5751 30.2002 42.1108 29.9769 42.6695 29.9766Z" fill="#ED1B2F"/>
					        <path d="M51.546 46.4424H60.2226C60.72 46.4424 61.1969 46.6411 61.5486 46.9946C61.9003 47.3482 62.0978 47.8277 62.0978 48.3277V48.3852C62.0978 48.6327 62.0493 48.8778 61.9551 49.1065C61.8608 49.3351 61.7227 49.5428 61.5485 49.7178C61.3744 49.8927 61.1676 50.0315 60.9401 50.126C60.7126 50.2206 60.4688 50.2692 60.2226 50.269H47.7188V29.9766H60.0704C60.3166 29.9766 60.5604 30.0253 60.7878 30.1201C61.0153 30.2149 61.2219 30.3537 61.3959 30.5288C61.5699 30.7039 61.7079 30.9117 61.802 31.1404C61.8961 31.3692 61.9444 31.6143 61.9443 31.8618V31.9193C61.9443 32.1667 61.8958 32.4117 61.8016 32.6402C61.7074 32.8688 61.5694 33.0765 61.3954 33.2514C61.2214 33.4263 61.0148 33.5651 60.7875 33.6598C60.5602 33.7544 60.3165 33.8032 60.0704 33.8032H51.546V38.1225H59.6934C59.9396 38.1225 60.1834 38.1712 60.4108 38.266C60.6383 38.3608 60.8449 38.4996 61.0189 38.6747C61.1929 38.8498 61.3309 39.0576 61.425 39.2864C61.5191 39.5151 61.5674 39.7602 61.5673 40.0077C61.5673 40.2551 61.5188 40.5 61.4246 40.7286C61.3304 40.9572 61.1924 41.1648 61.0184 41.3398C60.8444 41.5147 60.6378 41.6534 60.4105 41.7481C60.1832 41.8428 59.9395 41.8915 59.6934 41.8915H51.546V46.4424Z" fill="#ED1B2F"/>
					        <path d="M77.6508 31.8899C77.6508 32.1415 77.6014 32.3906 77.5055 32.623C77.4096 32.8554 77.2691 33.0665 77.0919 33.2443C76.9147 33.422 76.7044 33.5628 76.473 33.6587C76.2417 33.7546 75.9937 33.8037 75.7435 33.8032H72.2667V48.3557C72.2667 48.8632 72.0662 49.3498 71.7093 49.7087C71.3523 50.0675 70.8683 50.269 70.3635 50.269H69.9558C69.451 50.269 68.967 50.0675 68.6101 49.7087C68.2531 49.3498 68.0526 48.8632 68.0526 48.3557V33.8032H64.6024C64.0976 33.8032 63.6136 33.6016 63.2566 33.2428C62.8997 32.884 62.6992 32.3973 62.6992 31.8899C62.6992 31.3824 62.8997 30.8958 63.2566 30.537C63.6136 30.1781 64.0976 29.9766 64.6024 29.9766H75.7435C75.9937 29.9762 76.2415 30.0254 76.4728 30.1214C76.7041 30.2173 76.9144 30.3582 77.0915 30.5359C77.2686 30.7136 77.4092 30.9246 77.5052 31.1569C77.6011 31.3892 77.6506 31.6383 77.6508 31.8899Z" fill="#ED1B2F"/>
					        <path d="M116.752 43.9971C118.247 43.2675 119.452 42.0498 120.169 40.5428C120.886 39.0359 121.073 37.329 120.7 35.7011C120.328 34.0733 119.416 32.6207 118.116 31.5808C116.815 30.541 115.203 29.9754 113.541 29.9766L103.383 30.0004V50.4389H107.798V33.7821H113.541C114.395 33.7811 115.222 34.0889 115.869 34.6494C116.517 35.2098 116.942 35.9856 117.068 36.8352C117.194 37.6848 117.012 38.5516 116.555 39.2775C116.098 40.0034 115.397 40.5401 114.58 40.7896L113.602 39.3423H108.953L116.472 50.4319H121.124L116.752 43.9971Z" fill="#1E4382"/>
					        <path d="M90.6291 29.6243C87.8623 29.5557 85.181 30.5909 83.1711 32.5037C81.1613 34.4166 79.9864 37.0515 79.9032 39.8326C79.82 42.6137 80.8352 45.3149 82.7271 47.3457C84.6189 49.3766 87.2335 50.5719 89.9993 50.6706C90.2074 50.6832 90.4182 50.6916 90.6291 50.6916H93.8182L91.1345 46.7317H90.6291C89.1687 46.733 87.7497 46.2445 86.5966 45.3437C85.4435 44.4429 84.6221 43.1811 84.2627 41.7582C83.9032 40.3352 84.0261 38.8324 84.6119 37.4876C85.1977 36.1428 86.2129 35.0328 87.4969 34.3334C88.7808 33.6339 90.2602 33.385 91.7007 33.626C93.1412 33.8671 94.4606 34.5842 95.4501 35.664C96.4395 36.7438 97.0424 38.1245 97.1634 39.5876C97.2843 41.0507 96.9165 42.5125 96.1179 43.7417L93.9858 40.5959H90.185L93.7931 45.9203L96.5228 49.9603L96.8468 50.439H100.648L98.4428 47.1683C99.7913 45.6525 100.674 43.7767 100.985 41.7673C101.296 39.7579 101.021 37.701 100.194 35.8452C99.3672 33.9894 98.0233 32.4141 96.3249 31.3096C94.6265 30.2051 92.6462 29.6188 90.6235 29.6215L90.6291 29.6243Z" fill="#1E4382"/>
					        <path d="M19.8836 50.4879C19.7062 50.4792 19.5275 50.462 19.3516 50.4375C19.5289 50.462 19.7062 50.4792 19.8836 50.4879Z" stroke="#231F20" stroke-width="0.3"/>
					        <path d="M20.9987 50.4375H20.9727H20.9987Z" stroke="#231F20" stroke-width="0.3"/>
					        <path d="M20.4433 50.4883C20.3498 50.4883 20.2576 50.4883 20.1641 50.4883C20.2576 50.4897 20.3512 50.4926 20.4433 50.4883Z" stroke="#231F20" stroke-width="0.3"/>
					        <path d="M19.3489 50.4375H19.3242H19.3489Z" stroke="#231F20" stroke-width="0.3"/>
					        <path d="M20.1621 50.4922C20.0685 50.4922 19.9764 50.4922 19.8828 50.4922C19.9764 50.4951 20.0685 50.4922 20.1621 50.4922Z" stroke="#231F20" stroke-width="0.3"/>
					        <path d="M20.9734 50.4375C20.7975 50.462 20.6201 50.4792 20.4414 50.4879C20.6187 50.4792 20.7961 50.462 20.9734 50.4375Z" stroke="#231F20" stroke-width="0.3"/>
					        <path d="M36.5002 17.6068C35.1142 16.7502 33.4465 16.482 31.8639 16.8613C30.2813 17.2407 28.9134 18.2364 28.061 19.6296L21.0404 31.1052L20.4525 32.0611C20.3464 32.2015 20.2375 32.3419 20.1188 32.4724C19.482 33.1884 18.6877 33.7448 17.7991 34.0973C16.9105 34.4499 15.9523 34.5888 15.0008 34.5031C14.0493 34.4173 13.131 34.1092 12.3189 33.6033C11.5069 33.0975 10.8237 32.4079 10.3238 31.5895L6.14745 24.7687C5.68503 24.0109 5.39158 23.1613 5.28733 22.2785C5.25527 22.0083 5.24081 21.7364 5.24404 21.4643C5.28322 20.6832 5.5595 19.933 6.0357 19.3146C6.5119 18.6962 7.16515 18.2393 7.90749 18.0054C8.64982 17.7716 9.4456 17.7721 10.1877 18.0067C10.9297 18.2414 11.5825 18.699 12.058 19.318C11.1638 17.9524 9.76672 16.9999 8.17398 16.6699C6.58124 16.3399 4.92333 16.6595 3.565 17.5584C2.20666 18.4573 1.25915 19.8619 0.930912 21.4631C0.602675 23.0643 0.920596 24.7311 1.81474 26.0967L14.7556 47.2454C15.2112 48.1035 15.8631 48.8403 16.6578 49.3951C17.4524 49.9499 18.3669 50.3067 19.3257 50.4361H19.3522C19.5282 50.46 19.7069 50.4768 19.8842 50.4852C19.9778 50.4852 20.0699 50.4852 20.1635 50.4852C20.257 50.4852 20.3492 50.4852 20.4427 50.4852C20.6215 50.4768 20.7988 50.46 20.9747 50.4361H21.0027C21.9614 50.3062 22.8757 49.9492 23.6702 49.3945C24.4648 48.8398 25.1169 48.1032 25.5727 47.2454L38.5122 26.0967C38.9354 25.4066 39.2191 24.6394 39.347 23.8391C39.4749 23.0387 39.4445 22.2208 39.2576 21.4322C39.0707 20.6437 38.731 19.8999 38.2578 19.2435C37.7847 18.5871 37.1874 18.0309 36.5002 17.6068Z" fill="#ED1B2F"/>
					        <path d="M14.9552 24.0264L12.2646 19.6299C12.2003 19.5232 12.1249 19.4249 12.0565 19.3239C11.5813 18.7052 10.9291 18.2476 10.1875 18.0128C9.44591 17.7779 8.65058 17.777 7.90846 18.0101C7.16634 18.2433 6.51304 18.6993 6.03644 19.3169C5.55984 19.9345 5.28279 20.684 5.24257 21.4646C5.23958 21.7348 5.25404 22.0048 5.28586 22.2731C5.39011 23.156 5.68356 24.0056 6.14598 24.7634L10.3265 31.5841C10.8264 32.4025 11.5096 33.0921 12.3217 33.598C13.1337 34.1038 14.0521 34.4119 15.0035 34.4977C15.955 34.5835 16.9132 34.4445 17.8018 34.092C18.6904 33.7394 19.4848 33.183 20.1215 32.4671L14.9552 24.0264Z" fill="#A01E21"/>
					    </g>
					</svg>
					
	                <img id="vietQrImage"
	                     th:src="@{'https://img.vietqr.io/image/BIDV-V3CASSSUSHIWA-qr_only.png?amount=' + ${#numbers.formatInteger(totalPayable, 0)} + '&addInfo=' + ${orderCode} +'user:' +${session.loggedInUser} + '&accountName=Huynh%20Thanh%20Phat'}"
	                     alt="M√£ QR VietQR"
	                     class="img-fluid"
	                     style="max-width: 60%; border: 2px solid white; border-radius: 10px;">

	                <p  class="mt-3" style="font-size: 18px;">
	                    <strong>S·ªë ti·ªÅn:</strong>
	                    <span class="text-warning" style="font-size: 22px;" th:text="${totalPayableFormatted}+'ƒë'">0</span>
	                </p>
					<p class="text-start" style="font-size: 16px;">
					    <strong>N·ªôi dung (b·∫Øt bu·ªôc):</strong> 
						<span class="text-info" th:text="${#strings.replace(orderCode, '-', '')}">M√É ƒê∆†N H√ÄNG</span>
					</p>

					<p class="text-start" style="font-size: 16px;">
					    <strong>Ng∆∞·ªùi th·ª• h∆∞·ªüng: HUYNH THANH PHAT</strong>
					</p>
					<hr> 
	                <div class="progress mt-4" style="height: 8px;" hidden>
	                    <div id="paymentProgress" class="progress-bar bg-warning" role="progressbar" style="width: 0%;"></div>
	                </div>
					<img src="https://mpos.vn/assets/landingV2/Landing-mPos-V2/mpos-assets/img/group-visa.svg" width="100%">
										
					<p class="text-light" style="font-size: 13px;">
						Nh·∫≠n ti·ªÅn t·ª´ m·ªçi Ng√¢n h√†ng v√† V√≠ ƒëi·ªán t·ª≠
					</p>
					
	                <p class="mt-2" id="paymentTimer" style="font-size: 14px;">ƒêang ch·ªù thanh to√°n 5:00</p>
					<div class="line-loading"></div>
					
					<button id="saveFullModal" class="btn btn-success mt-3">
					    <i class="fas fa-download"></i> L∆∞u ·∫£nh
					</button>

	                <button id="changePaymentMethod" class="btn btn-outline-primary mt-3"><i class="fas fa-sync-alt"></i>ƒê·ªïi ph∆∞∆°ng th·ª©c thanh to√°n</button>
	            </div>
	        </div>
	    </div>
	</div>

	<!-- Modal Thanh to√°n th√†nh c√¥ng -->
	<div class="modal fade" id="paymentSuccessModal" tabindex="-1" aria-hidden="true">
	    <div class="modal-dialog modal-dialog-centered">
	        <div class="modal-content" style="border-radius: 15px; background-color: #1D2453; color: white; text-align: center; padding: 20px;">
	            <div class="modal-body">
	                <h4 class="text-success">‚úÖ Thanh to√°n th√†nh c√¥ng</h4>
	                <div class="progress mt-3" style="height: 8px;">
	                    <div id="redirectProgress" class="progress-bar bg-info" role="progressbar" style="width: 0%;"></div>
	                </div>
	                <p class="mt-2" id="redirectTimer">B·∫Øt ƒë·∫ßu sau 5s</p>
	            </div>
	        </div>
	    </div>
	</div>

	<script>
		document.addEventListener("DOMContentLoaded", function () {
		    let timeLeft = 300; // 5 ph√∫t ƒë·∫øm ng∆∞·ª£c
		    let progressBar = document.getElementById("paymentProgress");
		    let timerText = document.getElementById("paymentTimer");
		    let orderCode = document.getElementById("orderCode").innerText.trim();
		    const totalPayable = parseInt(document.getElementById("totalPayable").innerText.trim(), 10);
		    const changePaymentBtn = document.getElementById("changePaymentMethod");
		    let paymentInterval;
		    let isPaymentSuccessful = false; // Bi·∫øn ki·ªÉm so√°t tr·∫°ng th√°i thanh to√°n
			let redirectCountdownStarted = false;
			let successModalShown = false;
			
			let paymentForm = document.getElementById("paymentForm"); // L·∫•y form thanh to√°n
			
			 let submitBtn = document.getElementById("submitBtn"); // N√∫t submit

			 // V√¥ hi·ªáu h√≥a n√∫t submit khi ch·ªçn VietQR
			 function checkSubmitStatus() {
			     let paymentMethod = document.getElementById("paymentMethod").value;
			     if (paymentMethod === "vietqr" && !isPaymentSuccessful) {
			         submitBtn.disabled = true;
			     } else {
			         submitBtn.disabled = false;
			     }
			 }
			 document.getElementById("paymentMethod").addEventListener("change", checkSubmitStatus);


		    // Lo·∫°i b·ªè d·∫•u '-' trong orderCode
		    orderCode = orderCode.replace(/-/g, "");
		    console.log("Order Code (ƒë√£ lo·∫°i b·ªè '-'): ", orderCode);
		    console.log("Total Payable:", totalPayable);

		    function startCountdown() {
		        let interval = setInterval(() => {
		            if (timeLeft <= 0) {
		                clearInterval(interval);
						clearInterval(paymentInterval);
						clearTimeout(); // X√≥a m·ªçi timeout

						$('#vietQrModal').modal('hide'); 
						$('#vietQrModal').removeClass('show');
						$('body').removeClass('modal-open');
						$('.modal-backdrop').remove();
		                $('#vietQrModal').modal('hide');
		                $('#paymentSuccessModal').modal('show');
		                startRedirectCountdown();
		            } else {
		                let minutes = Math.floor(timeLeft / 60);
		                let seconds = timeLeft % 60;
		                progressBar.style.width = ((300 - timeLeft) / 300 * 100) + "%";
		                timerText.innerText = `ƒêang ch·ªù thanh to√°n ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
		                timeLeft--;
		            }
		        }, 1000);
		    }

		    function startRedirectCountdown() {
				if (redirectCountdownStarted) return;
				redirectCountdownStarted = true;
		        let redirectTime = 5;
		        let redirectBar = document.getElementById("redirectProgress");
		        let redirectText = document.getElementById("redirectTimer");
		        let interval = setInterval(() => {
		            if (redirectTime <= 0) {
		                clearInterval(interval);
						clearInterval(paymentInterval);
						clearTimeout(); // X√≥a m·ªçi timeout

						$('#vietQrModal').modal('hide'); 
						$('#vietQrModal').removeClass('show');
						$('body').removeClass('modal-open');
						$('.modal-backdrop').remove();
						$('#vietQrModal').modal('hide');
						$('#paymentSuccessModal').modal('hide');
		            } else {
		                redirectBar.style.width = ((5 - redirectTime) * 20) + "%";
		                redirectText.innerText = `B·∫Øt ƒë·∫ßu sau ${redirectTime}s`;
		                redirectTime--;
		            }
		        }, 1000);
		    }

		    async function checkPayment() {
		        if (isPaymentSuccessful) {
		            console.log("‚úÖ ƒê√£ x√°c nh·∫≠n thanh to√°n th√†nh c√¥ng, d·ª´ng ki·ªÉm tra!");
		            return;
		        }

		        try {
		            const response = await fetch('https://script.google.com/macros/s/AKfycbxttABThmHWbgwFya4GEc4QX97ZkIUTHg40OePnNPYOuwbciKw20vaDcp6bfA69Zw-O/exec');
		            const data = await response.json();

		            if (data.error || !data.data) {
		                console.warn("‚ö† Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu giao d·ªãch.");
		                return;
		            }

		            const transactions = data.data;
		            const paymentFound = transactions.some(tx =>
		                tx["M√¥ t·∫£"].includes(orderCode) && tx["Gi√° tr·ªã"] === totalPayable
		            );

		            if (paymentFound) {
		                console.log("‚úÖ Thanh to√°n th√†nh c√¥ng!");

						isPaymentSuccessful = true; // ƒê√°nh d·∫•u tr·∫°ng th√°i thanh to√°n th√†nh c√¥ng
						clearInterval(paymentInterval); // D·ª´ng ki·ªÉm tra
						clearTimeout(); // X√≥a m·ªçi timeout

						$('#vietQrModal').modal('hide'); 
						$('#vietQrModal').removeClass('show');
						$('body').removeClass('modal-open');
						$('.modal-backdrop').remove();
					
		                // ƒê·∫£m b·∫£o modal VietQR ƒë√£ ·∫©n r·ªìi m·ªõi hi·ªán modal th√†nh c√¥ng
						if (!successModalShown) {
	                   successModalShown = true;
	                   setTimeout(() => {
	                       $('#paymentSuccessModal').modal('show');
	                       startRedirectCountdown();
	                   }, 500);}
		            } else {
		                console.log("‚è≥ Ch∆∞a nh·∫≠n ƒë∆∞·ª£c thanh to√°n, ti·∫øp t·ª•c ki·ªÉm tra...");
		            }
		        } catch (error) {
		            console.error("‚ùå L·ªói khi ki·ªÉm tra thanh to√°n:", error);
		        }
				// Khi modal thanh to√°n th√†nh c√¥ng b·ªã ·∫©n -> Submit form
				   $('#paymentSuccessModal').on('hidden.bs.modal', function () {
				       console.log("üìå Modal thanh to√°n th√†nh c√¥ng ƒë√£ ·∫©n, ti·∫øn h√†nh submit form...");

				       if (paymentForm) {
				           paymentForm.submit();
						   // Ch·ªù 3 gi√¢y r·ªìi chuy·ªÉn h∆∞·ªõng ƒë·∫øn /processCheckout
					         setTimeout(function () {
					             window.location.href = "/checkoutSuccess";
					         }, 1500);
				       } else {
				           console.error("‚ö† Kh√¥ng t√¨m th·∫•y form thanh to√°n!");
				       }
				   });
		    }

		    $('#vietQrModal').on('shown.bs.modal', function () {
		        startCountdown();
		        paymentInterval = setInterval(checkPayment, 1000); // Ki·ªÉm tra m·ªói 5 gi√¢y
		    });

		    changePaymentBtn.addEventListener("click", function () {
		        if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒë·ªïi ph∆∞∆°ng th·ª©c thanh to√°n kh√¥ng?")) {
		            clearInterval(paymentInterval);
		            $('#vietQrModal').modal('hide');
		            location.reload(); // Load l·∫°i trang sau khi ƒë·ªïi ph∆∞∆°ng th·ª©c thanh to√°n
		        }
		    });

		    // ƒê·∫£m b·∫£o modal VietQR ƒë∆∞·ª£c ƒë√≥ng ƒë√∫ng c√°ch
		    $('#vietQrModal').on('hidden.bs.modal', function () {
		        clearInterval(paymentInterval);
		    });
		});
		document.addEventListener("DOMContentLoaded", function () {
		    let saveButton = document.getElementById("saveFullModal");
		    let modal = document.getElementById("vietQrModal");

		    saveButton.addEventListener("click", function () {
		        html2canvas(modal, { scale: 2 }).then(canvas => {
		            let link = document.createElement("a");
		            link.href = canvas.toDataURL("image/png");
		            link.download = "VietQR_Payment.png";
		            document.body.appendChild(link);
		            link.click();
		            document.body.removeChild(link);
		        });
		    });
		});

	</script>


	<script>
		document.addEventListener("DOMContentLoaded", function () {
		    var vietQrModal = document.getElementById("vietQrModal");

		    // Khi modal m·ªü, th√™m l·ªõp ph·ªß
		    vietQrModal.addEventListener("shown.bs.modal", function () {
		        document.querySelector(".modal-overlay").style.display = "block";
		    });

		    // NgƒÉn modal b·ªã ƒë√≥ng khi b·∫•m v√†o l·ªõp ph·ªß
		    document.querySelector(".modal-overlay").addEventListener("click", function (event) {
		        event.stopPropagation(); // NgƒÉn s·ª± ki·ªán b·∫•m ra ngo√†i ƒë√≥ng modal
		    });
		});

	</script>


	<script>
	document.getElementById("paymentMethod").addEventListener("change", function () {
	    if (this.value === "momo") {
	        // M·ªü modal khi ph∆∞∆°ng th·ª©c thanh to√°n l√† MoMo
	        new bootstrap.Modal(document.getElementById("momoQrModal")).show();
	    }
	});
	document.getElementById("paymentMethod").addEventListener("change", function () {
		    if (this.value === "vietqr") {
		        // M·ªü modal khi ph∆∞∆°ng th·ª©c thanh to√°n l√† MoMo
		        new bootstrap.Modal(document.getElementById("vietQrModal")).show();
		    }
		});
	</script>
	<div id="imageModal" class="modal" style="display: none;">
		    <span class="close" onclick="closeModal()">&times;</span>
		        <img class="modal-content2" id="modalImage">
		    <div class="controls">
		        <button onclick="zoomOut()">-</button>
		        <button onclick="zoomIn()">+</button>
		    </div>
		</div>
	<footer class="footer mt-4">
	       <div class="container">
	           <div class="row">
	               <div class="col-md-4">
	                   <h5 class="footer-logo">Sushi Wa</h5>
	                   <p>Sushi v√† L·∫©u BƒÉng chuy·ªÅn t·∫°i T·∫ßng B1 GigaMall Tp.Th·ªß ƒê·ª©c</p>
	               </div>
	               <div class="col-md-4">
	                   <h5>B·∫°n c·∫ßn h·ªó tr·ª£</h5>
	                   <p>
	                       <strong>Hoteline: 097 480 2998</strong><br>
	                       ƒê·ªãa ch·ªâ: T·∫ßng B1, TTTM GigaMall, 240-242 Ph·∫°m VƒÉn ƒê·ªìng, Hi·ªáp B√¨nh Ch√°nh, Th·ªß ƒê·ª©c, Tp. H·ªì Ch√≠ Minh<br>
	                       Email: <a href="mailto:hotro.sushiwa@gmail.com">hotro.sushiwa@gmail.com</a>
	                   </p>
					   <div class="social-icons">
					       <a href="https://www.facebook.com/sushiwa" target="_blank" aria-label="Facebook">
					           <i class="fab fa-facebook-f"></i>
					       </a>
					       <a href="https://www.twitter.com" target="_blank" aria-label="Twitter">
					           <i class="fab fa-twitter"></i>
					       </a>
					       <a href="https://www.youtube.com" target="_blank" aria-label="YouTube">
					           <i class="fab fa-youtube"></i>
					       </a>
					       <a href="https://www.instagram.com" target="_blank" aria-label="Instagram">
					           <i class="fab fa-instagram"></i>
					       </a>
					   </div>
					   <div class="payment-icons mt-3">
					       <a href="https://visa.com" target="_blank" aria-label="Stripe">
					           <img src="https://cdn-icons-png.flaticon.com/512/196/196578.png" alt="Visa">
					       </a>
					       <a href="https://www.mastercard.com" target="_blank" aria-label="mastercard">
					           <img src="https://cdn-icons-png.flaticon.com/512/196/196561.png" alt="Mastercard">
					       </a>
					       <a href="https://www.stripe.com" target="_blank" aria-label="Visa">
					           <img src="https://cdn-icons-png.flaticon.com/512/825/825425.png" alt="Stripe">
					       </a>
					       <a href="https://www.paypal.com" target="_blank" aria-label="MasterCard">
					           <img src="https://cdn-icons-png.flaticon.com/512/196/196565.png" alt="Paypal">
					       </a>
					   </div>
	               </div>
	               <div class="col-md-2">
	                   <h5>H∆∞·ªõng d·∫´n</h5>
	                   <ul class="list-unstyled">
	                       <li><a href="#">C√°ch ƒë·∫∑t m√≥n</a></li>
	                       <li><a href="#">Ph∆∞∆°ng th·ª©c thanh to√°n</a></li>
	                       <li><a href="#">Giao h√†ng t·∫≠n n∆°i</a></li>
	                       <li><a href="#">Ch√≠nh s√°ch ƒë·ªïi tr·∫£</a></li>
	                       <li><a href="#">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</a></li>
	                   </ul>
	               </div>
	               <div class="col-md-2">
	                   <h5>H·ªó tr·ª£ kh√°ch h√†ng</h5>
	                   <ul class="list-unstyled">
	                       <li><a href="#">Li√™n h·ªá ch√∫ng t√¥i</a></li>
	                       <li><a href="#">T∆∞ v·∫•n th·ª±c ƒë∆°n</a></li>
	                       <li><a href="#">H∆∞·ªõng d·∫´n ƒë·∫∑t ti·ªác</a></li>
	                       <li><a href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
	                       <li><a href="#">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
	                   </ul>
	               </div>
	           </div>
	       </div>
	</footer>

	<script>
		// C·∫≠p nh·∫≠t thanh ti·∫øn tr√¨nh trong kho·∫£ng th·ªùi gian n√†y
		function updateProgressBarBasedOnTime() {
		    var progressBar = document.getElementById('progressBar');
		    var progressPercent = document.getElementById('progressPercent');
		    var totalTime = 5000; // T·ªïng th·ªùi gian g·ª≠i email (5000ms)
		    var intervalTime = 6; // C·∫≠p nh·∫≠t m·ªói 50ms
		    var width = 0;
		    var totalUpdates = totalTime / intervalTime;

		    var interval = setInterval(function () {
		        if (width >= 100) {
		            clearInterval(interval);
		        } else {
		            width += 100 / totalUpdates;
		            progressBar.style.width = width + '%';
		            progressPercent.textContent = Math.floor(width) + '%';
		        }
		    }, intervalTime);
		}

		// Ki·ªÉm tra xem t·∫•t c·∫£ c√°c tr∆∞·ªùng ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅn ƒë·∫ßy ƒë·ªß ch∆∞a
		function validateForm() {
		    var isValid = true;
		    var fields = [
		        { id: 'fullname', name: 'Ng∆∞·ªùi nh·∫≠n h√†ng' },
		        { id: 'phoneNumber', name: 'S·ªë ƒëi·ªán tho·∫°i' },
		        { id: 'address', name: 'ƒê·ªãa ch·ªâ giao h√†ng' },
		        { id: 'deliveryTime', name: 'Gi·ªù giao h√†ng' },
		        { id: 'paymentMethod', name: 'Ph∆∞∆°ng th·ª©c thanh to√°n' }
		    ];
		    var errorMessage = "";

		    fields.forEach(field => {
		        var input = document.getElementById(field.id);
		        if (!input.value.trim()) {
		            input.style.border = "2px solid red";
		            errorMessage += `- ${field.name} ch∆∞a ƒë∆∞·ª£c ch·ªçn!\n`;
		            isValid = false;
		        } else {
		            input.style.border = "";
		        }
		    });

		    if (!isValid) {
		        alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin tr∆∞·ªõc khi thanh to√°n:\n" + errorMessage);
		    }
		    return isValid;
		}

		// X·ª≠ l√Ω khi nh·∫•n n√∫t thanh to√°n
		const thanhToanButton = document.querySelector('button.btn.btn-primary.w-100');
		thanhToanButton.addEventListener("click", function (event) {
		    event.preventDefault();

		    if (!validateForm()) {
		        return;
		    }

		    var myModal = new bootstrap.Modal(document.getElementById('loadingModal'));
		    myModal.show();
		    updateProgressBarBasedOnTime();

		    setTimeout(function () {
		        // G·ª≠i form tr∆∞·ªõc
		        thanhToanButton.closest("form").submit();

		        // Chuy·ªÉn h∆∞·ªõng sau 2 gi√¢y
		        setTimeout(function () {
		            window.location.href = "/checkoutSuccess";
		        }, 2000);
		    }, 0.1); // Gi·∫£ l·∫≠p vi·ªác g·ª≠i email trong 1 gi√¢y (c√≥ th·ªÉ ƒëi·ªÅu ch·ªânh)
		});
		function openModal(imgElement) {
			       var modal = document.getElementById("imageModal");
			       var modalImg = document.getElementById("modalImage");

			       // Ch·ªâ hi·ªÉn th·ªã modal khi ng∆∞·ªùi d√πng nh·∫•p v√†o ·∫£nh
			       if (imgElement && imgElement.src) {
			           modal.classList.add("show");
			           modal.style.display = "flex"; 
			           modalImg.src = imgElement.src;
			           modalImg.style.transform = "scale(1)"; // Reset scale
			       }
			   }

			   function closeModal() {
			       var modal = document.getElementById("imageModal");
			       modal.classList.remove("show");
			       modal.style.display = "none"; 
			   }


			   function zoomIn() {
			       var img = document.getElementById("modalImage");
			       var scale = getCurrentScale(img) + 0.2;
			       img.style.transform = `scale(${scale})`;
			   }

			   function zoomOut() {
			       var img = document.getElementById("modalImage");
			       var scale = getCurrentScale(img) - 0.2;
			       if (scale > 0.5) { // Gi·ªõi h·∫°n thu nh·ªè
			           img.style.transform = `scale(${scale})`;
			       }
			   }

			   function getCurrentScale(img) {
			       var transform = window.getComputedStyle(img).transform;
			       if (transform !== "none") {
			           var matrix = transform.match(/matrix\((.+)\)/);
			           if (matrix) {
			               return parseFloat(matrix[1].split(", ")[0]);
			           }
			       }
			       return 1;
			   }
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

	<!-- Bootstrap JS (c·∫ßn thi·∫øt cho modal v√† c√°c th√†nh ph·∫ßn Bootstrap kh√°c) -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
		<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
